<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="An analysis of the Ability Power changes in 5.13">
        <meta name="keywords" content="league of legends, ap, patch, change, meta">
        <meta name="author" content="Matt D'Souza and Dongyu Zheng">
        <title>Metashift | An analysis of the Ability Power changes in 5.13</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
        <link rel="stylesheet" href="https://cdn.datatables.net/1.10.8/css/jquery.dataTables.min.css">
        <style>
            .table-no-div th, .table-no-div td { 
                 border-top: none !important; 
             }
        </style>
    </head>

    <body>
        <h1 class="text-center">Metashift</h1>
        <br><br>
        <div class="row">
            <div class="col-xs-1"></div>
            <div class="col-xs-10">
                <table class="table table-condensed table-no-div">  
                    <thead>  
                        <tr>
                            <th>Data Type</th>
                            <th>Sorting</th>
                            <th>Game Mode</th>
                            <th>Region</th>
                        </tr>  
                    </thead>  
                    <tbody>  
                        <tr>  
                            <td><input type="radio" name="data-type" value="wr" checked>Win Rate</input></td>
                            <td>
                                <select id="sort-type" class="form-control">
                                    <option value="name">Champion name</option>
                                    <option value="pre_wr">Win rate (pre-patch)</option>
                                    <option value="post_wr">Win rate (post-patch)</option>
                                    <option value="d_wr">Win rate (change)</option>
                                    <option value="pre_pr">Pick rate (pre-patch)</option>
                                    <option value="post_pr">Pick rate (post-patch)</option>
                                    <option value="d_pr">Pick rate (change)</option>
                                </select>
                            </td>
                            <td><input type="checkbox" name="queue" value="normal_5x5">Normal</input></td>
                            <td>
                                <input type="checkbox" name="region" value="ALL" onclick="return false;" disabled="disabled">All</input>
                                <button type="button" class="btn btn-primary pull-right" id="update-selection">Update Selection</button>
                            </td>
                        </tr>  
                        <tr>
                            <td><input type="radio" name="data-type" value="pr">Pick Rate</input></td>
                            <td>
                                Currently sorting by: <span id="currently-sorting-by">Champion name</span>
                            </td>
                            <td><input type="checkbox" name="queue" value="ranked_solo">Ranked</input></td>
                            <td>
                                <div class="row">
                                    <div class="col-xs-2">
                                        <input type="checkbox" name="region" value="NA">NA</input>
                                    </div>
                                    <div class="col-xs-2">
                                        <input type="checkbox" name="region" value="EUW" onclick="return false;" disabled="disabled">EUW</input>
                                    </div>
                                    <div class="col-xs-2">
                                        <input type="checkbox" name="region" value="EUNE" onclick="return false;" disabled="disabled">EUNE</input>
                                    </div>
                                    <div class="col-xs-2">
                                        <input type="checkbox" name="region" value="KR" onclick="return false;" disabled="disabled">KR</input>
                                    </div>
                                    <div class="col-xs-2">
                                        <input type="checkbox" name="region" value="BR" onclick="return false;" disabled="disabled">BR</input>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-2">
                                        <input type="checkbox" name="region" value="LAN" onclick="return false;" disabled="disabled">LAN</input>
                                    </div>
                                    <div class="col-xs-2">
                                        <input type="checkbox" name="region" value="LAS">LAS</input>
                                    </div>
                                    <div class="col-xs-2">
                                        <input type="checkbox" name="region" value="OCE" onclick="return false;" disabled="disabled">OCE</input>
                                    </div>
                                    <div class="col-xs-2">
                                        <input type="checkbox" name="region" value="RU" onclick="return false;" disabled="disabled">RU</input>
                                    </div>
                                    <div class="col-xs-2">
                                        <input type="checkbox" name="region" value="TR" onclick="return false;" disabled="disabled">TR</input>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>  
                </table> 
            </div>
        </div>
        <br>
        <div class="row">
            <div id="container" style="width:80%; height:1500px; margin-left:auto; margin-right:auto;"></div>
        </div>
        <br>
        <div class="row" style="width:95%; margin-left:auto; margin-right:auto;">
            <h2 class="text-center">Table</h2>
            <div class="row">
                <div class="col-xs-6">
                    <strong>A: v5.11<br>
                    B: v5.14</strong>
                </div>
                <div class="col-xs-6 text-right">
                    <strong>Toggle:</strong> <button type="button" class="btn btn-info active" id="wins-picks-chart">Win/Pick Rate</button> <button type="button" class="btn btn-info" id="roles-chart">Roles</button>
                </div>
            </div>
            <br>
            <table id="example" class="display" cellspacing="0" width="100%">
                <thead>
                    <tr>
                        <th>Champion</th>
                        <th>Win (A)</th>
                        <th>Win (B)</th>
                        <th>&Delta; Win</th>
                        <th>Pick (A)</th>
                        <th>Pick (B)</th>
                        <th>&Delta; Pick</th>
                        <th>Fighter (A)</th>
                        <th>Fighter (B)</th>
                        <th>Mage (A)</th>
                        <th>Mage (B)</th>
                        <th>Marksman (A)</th>
                        <th>Marksman (B)</th>
                        <th>Support (A)</th>
                        <th>Support (B)</th>
                        <th>Tank (A)</th>
                        <th>Tank (B)</th>
                    </tr>
                </thead>
                <tfoot>
                    <tr>
                        <th>Champion</th>
                        <th>Pre Win Rate</th>
                        <th>Post Win Rate</th>
                        <th>Change in Win Rate</th>
                        <th>Pre Pick Rate</th>
                        <th>Post Pick Rate</th>
                        <th>Change in Pick Rate</th>
                        <th>Fighter (A)</th>
                        <th>Fighter (B)</th>
                        <th>Mage (A)</th>
                        <th>Mage (B)</th>
                        <th>Marksman (A)</th>
                        <th>Marksman (B)</th>
                        <th>Support (A)</th>
                        <th>Support (B)</th>
                        <th>Tank (A)</th>
                        <th>Tank (B)</th>
                    </tr>
                </tfoot>
                <tbody>
                </tbody>
            </table>
        </div>

        <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
        <script src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
        <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <script src="https://code.highcharts.com/highcharts.js"></script>
        <script src="https://code.highcharts.com/highcharts-more.js"></script>
        <script src="https://cdn.datatables.net/1.10.8/js/jquery.dataTables.min.js"></script>
        <script src="js/graphing.js"></script>
        <script>
            function green(text){
                return "<span style='color:green'>" + text + "</span>";
            }
            function red(text){
                return "<span style='color:red'>" + text + "</span>";
            }
            $(document).ready(function() {
                var $table = $('#example').DataTable( {
                    "bPaginate": false,
                    "columnDefs": [
                        {
                            "targets": [ 7,8,9,10,11,12,13,14,15,16 ],
                            "visible": false
                        }
                    ]
                } );
                $.getJSON('json/NORMAL_5X5_NA_CHAMPIONS.json', function(json) {
                    $table.clear();
                    for (champion of json) {
                        var d_wr = champion['d_wr'] >= 0.0 ? green(champion['d_wr'].toFixed(2) + "%") : red(champion['d_wr'].toFixed(2) + "%");
                        var d_pr = champion['d_pr'] >= 0.0 ? green(champion['d_pr'].toFixed(2) + "%") : red(champion['d_pr'].toFixed(2) + "%");
                        $table.row.add( [
                            champion['name'],
                            champion['pre_wr'].toFixed(2) + "%",
                            champion['post_wr'].toFixed(2) + "%",
                            d_wr,
                            champion['pre_pr'].toFixed(2) + "%",
                            champion['post_pr'].toFixed(2) + "%",
                            d_pr,
                            champion['pre_roles']['fighter'].toFixed(2) + "%",
                            champion['post_roles']['fighter'].toFixed(2) + "%",
                            champion['pre_roles']['mage'].toFixed(2) + "%",
                            champion['post_roles']['mage'].toFixed(2) + "%",
                            champion['pre_roles']['marksman'].toFixed(2) + "%",
                            champion['post_roles']['marksman'].toFixed(2) + "%",
                            champion['pre_roles']['support'].toFixed(2) + "%",
                            champion['post_roles']['support'].toFixed(2) + "%",
                            champion['pre_roles']['tank'].toFixed(2) + "%",
                            champion['post_roles']['tank'].toFixed(2) + "%",
                        ] );
                    }
                    $table.draw();
                });
                $('#wins-picks-chart').on('click', function(){
                    $(this).hasClass('active') ? $(this).removeClass('active') : $(this).addClass('active');
                    for (var i=1; i<=6; i++) {
                        var column = $table.column( i );
                        column.visible( ! column.visible() );
                    }
                });
                $('#roles-chart').on('click', function(){
                    $(this).hasClass('active') ? $(this).removeClass('active') : $(this).addClass('active');
                    for (var i=7; i<=16; i++) {
                        var column = $table.column( i );
                        column.visible( ! column.visible() );
                    }
                });
            } );
        </script>
    </body>
</html>